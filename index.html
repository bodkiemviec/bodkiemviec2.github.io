<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Shop Bod Gaming ‚Äî Mua b√°n Acc Roblox</title>
  <style>
    /* Reset + base */
    *{box-sizing:border-box}body{font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;line-height:1.4;margin:0;color:#111;background:#f7f7f8}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}

    /* Header */
    .top{background:#0b1226;color:#fff;padding:10px 16px;display:flex;align-items:center;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:44px;height:44px;border-radius:8px;background:linear-gradient(135deg,#ff6b6b,#feca57);display:flex;align-items:center;justify-content:center;font-weight:700;color:#111}
    .brand h1{font-size:16px;margin:0}
    nav{display:flex;gap:12px;align-items:center}
    .navlink{padding:8px 12px;border-radius:8px;background:transparent;color:#fff;cursor:pointer}
    .navlink:hover{background:rgba(255,255,255,0.06)}

    /* Main layout */
    .container{max-width:1100px;margin:18px auto;padding:0 16px}
    .top-row{display:flex;gap:18px}
    .left{width:260px}
    .right{flex:1}

    /* Search + filters */
    .card{background:#fff;border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(10,10,10,0.06)}
    .search-box{display:flex;gap:8px}
    .search-box input{flex:1;padding:10px;border-radius:8px;border:1px solid #e6e7ee}
    .search-box button{padding:10px 12px;border-radius:8px;border:none;background:#0b1226;color:#fff;cursor:pointer}
    .filters{margin-top:12px;display:flex;flex-direction:column;gap:10px}
    .filter-group h4{margin:0 0 6px 0;font-size:13px;color:#6b7280}
    .tags{display:flex;flex-wrap:wrap;gap:8px}
    .tag{padding:6px 8px;border-radius:999px;border:1px solid #e3e6ef;font-size:13px;background:#fcfcfd;cursor:pointer}
    .tag.active{background:#0b1226;color:#fff;border-color:transparent}

    /* Products grid */
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px;margin-top:12px}
    .acc{background:#fff;padding:10px;border-radius:10px;cursor:pointer;border:1px solid #eef0f6}
    .acc .title{font-weight:700;margin:8px 0 4px}
    .acc .id{font-size:12px;color:#6b7280}
    .acc .price{font-weight:700;margin-top:8px}
    .acc .tags{margin-top:8px}
    .acc .tag{font-size:12px;padding:4px 6px}

    /* Footer */
    footer{margin-top:28px;padding:18px;background:#0b1226;color:#fff;border-top:4px solid #0b0f1a}
    .footer-grid{display:flex;gap:24px;flex-wrap:wrap}
    .footer-grid .col{min-width:220px}
    .footer-grid h4{margin:0 0 8px 0}
    .muted{color:#cbd5e1;font-size:13px}

    /* Modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:flex;align-items:center;justify-content:center;padding:18px}
    .modal{width:100%;max-width:720px;background:#fff;padding:16px;border-radius:12px}
    .modal h3{margin:0 0 10px}
    .row{display:flex;gap:10px}

    /* small helpers */
    .btn{display:inline-block;padding:8px 12px;border-radius:8px;border:none;background:#0b1226;color:#fff;cursor:pointer}
    .muted-small{font-size:12px;color:#6b7280}
    input[type=range]{width:100%}
    .wallet{background:#fff;padding:8px;border-radius:8px}

    /* responsive */
    @media (max-width:900px){.top-row{flex-direction:column}.left{width:100%}.grid{grid-template-columns:repeat(auto-fill,minmax(180px,1fr))}}
  </style>
</head>
<body>
  <header class="top">
    <div class="brand">
      <div class="logo" id="homeBtn">SB</div>
      <div>
        <h1>Shop Bod Gaming</h1>
        <div class="muted-small">Mua b√°n Acc & Robux ‚Äî Uy t√≠n & An to√†n</div>
      </div>
    </div>
    <nav>
      <div class="navlink" id="nav-nap">N·∫°p ti·ªÅn</div>
      <div class="navlink" id="nav-help">H∆∞·ªõng d·∫´n</div>
      <div class="navlink" id="nav-news">Tin t·ª©c</div>
      <div class="navlink" id="authBtn">ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω</div>
    </nav>
  </header>

  <main class="container">
    <div class="top-row">
      <aside class="left">
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
            <strong>T√¨m ki·∫øm</strong>
            <span class="muted-small">B·ªô l·ªçc nhanh</span>
          </div>
          <div class="search-box">
            <input id="searchInput" placeholder="T√¨m theo t√™n, id, tag..." />
            <button id="searchBtn">T√¨m</button>
          </div>

          <div class="filters">
            <div class="filter-group">
              <h4>Danh m·ª•c game</h4>
              <div id="categoryList" class="tags"></div>
            </div>

            <div class="filter-group">
              <h4>Tags (v√≠ d·ª•: c√≥ pet)</h4>
              <div id="tagList" class="tags"></div>
            </div>

            <div class="filter-group">
              <h4>Kho·∫£ng gi√°</h4>
              <div><input type="range" id="priceRange" min="0" max="200" value="200" /></div>
              <div class="muted-small">Gi√° t·ªëi ƒëa: <span id="priceMax">200</span>k</div>
            </div>

            <div class="filter-group">
              <h4>S·∫Øp x·∫øp</h4>
              <select id="sortBy" style="width:100%;padding:8px;border-radius:8px;border:1px solid #e6e7ee">
                <option value="new">M·ªõi nh·∫•t</option>
                <option value="price-asc">Gi√° th·∫•p ‚Üí cao</option>
                <option value="price-desc">Gi√° cao ‚Üí th·∫•p</option>
              </select>
            </div>
          </div>

        </div>

        <div style="height:12px"></div>

        <div class="card">
          <strong>V√≠ c·ªßa b·∫°n</strong>
          <div style="margin-top:8px">
            <div id="walletBox" class="wallet">Ch∆∞a ƒëƒÉng nh·∫≠p</div>
            <div style="margin-top:8px;display:flex;gap:8px">
              <button class="btn" id="openNap">N·∫°p ti·ªÅn</button>
              <button class="btn" id="logoutBtn" style="background:#e74c3c;display:none">ƒêƒÉng xu·∫•t</button>
            </div>
          </div>
        </div>

      </aside>

      <section class="right">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px">
          <div style="display:flex;flex-direction:column">
            <div class="muted-small">K·∫øt qu·∫£ t√¨m ki·∫øm</div>
            <h2 id="resultsTitle">T·∫•t c·∫£ acc</h2>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn" id="btn-add-sample">Th√™m sample</button>
            <button class="btn" id="btn-clear-filters">X√≥a l·ªçc</button>
          </div>
        </div>

        <div id="grid" class="grid" aria-live="polite"></div>

      </section>
    </div>

    <footer>
      <div class="container" style="padding:0">
        <div class="footer-grid">
          <div class="col">
            <h4>V·ªÅ Shop Bod Gaming</h4>
            <p class="muted">L·ª±a Ch·ªçn S·ªë 1 Cho Mua B√°n Robux V√† Acc Roblox. Shoprobloxviet.vn n∆°i ƒë√°ng tin c·∫≠y cho m·ªçi game th·ªß Roblox. Uy T√≠n L√† Ni·ªÅm T·ª± H√†o, An To√†n L√† Ti√™u Ch√≠.</p>
          </div>
          <div class="col">
            <h4>Ch√≠nh s√°ch</h4>
            <ul class="muted-small" style="padding-left:0;list-style:none;margin:0">
              <li>Ch√≠nh s√°ch b·∫£o m·∫≠t</li>
              <li>Ch√≠nh s√°ch b√°n h√†ng</li>
              <li>Ch√≠nh s√°ch ƒë·ªïi tr·∫£</li>
              <li>ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</li>
              <li>H∆∞·ªõng d·∫´n mua acc</li>
              <li>C√¢u h·ªèi th∆∞·ªùng g·∫∑p</li>
            </ul>
          </div>
          <div class="col">
            <h4>Li√™n h·ªá</h4>
            <div class="muted">Hotline: ....</div>
            <div class="muted">Work time: 8h s√°ng - 11h khuya</div>
          </div>
        </div>

        <div style="margin-top:12px;text-align:center;color:#cfd8e3;font-size:13px">DMCA.com Protection Status ‚Äî ¬© shopbodgaming.vn</div>
      </div>
    </footer>
  </main>

  <!-- Modals -->
  <template id="productModalTpl">
    <div class="modal-backdrop">
      <div class="modal">
        <button style="float:right" class="btn" id="closeModal">ƒê√≥ng</button>
        <div style="clear:both"></div>
        <div style="display:flex;gap:12px;margin-top:8px">
          <div style="width:220px">
            <img id="prodImg" src="" alt="·∫¢nh acc" />
          </div>
          <div style="flex:1">
            <h3 id="prodName"></h3>
            <div class="muted-small">ID: <span id="prodId"></span></div>
            <div style="margin-top:8px" id="prodDesc"></div>
            <div class="tags" id="prodTags" style="margin-top:8px"></div>
            <div style="margin-top:12px;font-size:18px;font-weight:700">Gi√°: <span id="prodPrice"></span>k</div>

            <div style="margin-top:12px;display:flex;gap:8px">
              <button class="btn" id="buyBtn">Mua ngay</button>
              <button class="btn" id="favBtn">Th√™m y√™u th√≠ch</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </template>

  <template id="authTpl">
    <div class="modal-backdrop">
      <div class="modal">
        <button style="float:right" class="btn" id="closeAuth">ƒê√≥ng</button>
        <div style="clear:both"></div>
        <h3>ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω</h3>
        <div style="display:flex;gap:12px;margin-top:8px">
          <div style="flex:1">
            <h4>ƒêƒÉng nh·∫≠p</h4>
            <input id="loginUser" placeholder="T√™n ƒëƒÉng nh·∫≠p" style="width:100%;padding:8px;border:1px solid #e6e7ee;border-radius:8px;margin-bottom:8px" />
            <input id="loginPass" placeholder="M·∫≠t kh·∫©u" type="password" style="width:100%;padding:8px;border:1px solid #e6e7ee;border-radius:8px;margin-bottom:8px" />
            <button class="btn" id="doLogin">ƒêƒÉng nh·∫≠p</button>
          </div>

          <div style="flex:1">
            <h4>ƒêƒÉng k√Ω</h4>
            <input id="regUser" placeholder="T√™n ƒëƒÉng k√Ω" style="width:100%;padding:8px;border:1px solid #e6e7ee;border-radius:8px;margin-bottom:8px" />
            <input id="regPass" placeholder="M·∫≠t kh·∫©u" type="password" style="width:100%;padding:8px;border:1px solid #e6e7ee;border-radius:8px;margin-bottom:8px" />
            <button class="btn" id="doReg">T·∫°o t√†i kho·∫£n</button>
          </div>
        </div>
      </div>
    </div>
  </template>

  <template id="napTpl">
    <div class="modal-backdrop">
      <div class="modal">
        <button style="float:right" class="btn" id="closeNap">ƒê√≥ng</button>
        <div style="clear:both"></div>
        <h3>N·∫°p ti·ªÅn v√†o v√≠ (gi·∫£ l·∫≠p)</h3>
        <div style="margin-top:8px">
          <div class="muted-small">S·ªë ti·ªÅn (k)</div>
          <input id="napAmount" type="number" min="1" value="50" style="width:100%;padding:8px;border:1px solid #e6e7ee;border-radius:8px;margin-top:8px" />
          <div style="margin-top:8px;display:flex;gap:8px">
            <button class="btn" id="confirmNap">N·∫°p</button>
            <button class="btn" id="closeNap2">H·ªßy</button>
          </div>
        </div>
      </div>
    </div>
  </template>

  <script>
    // --- Data layer (localStorage simple DB) ---
    const DB = {
      usersKey: 'sb_users',
      sessionKey: 'sb_session',
      accsKey: 'sb_accs'
    }

    function loadJSON(key, fallback){
      try{const v = localStorage.getItem(key);return v?JSON.parse(v):fallback}catch(e){return fallback}
    }
    function saveJSON(key,obj){localStorage.setItem(key,JSON.stringify(obj))}

    // seed sample accounts if empty
    let accs = loadJSON(DB.accsKey, []);
    if(accs.length===0){
      accs = [
        {id:'#rbgag366',name:'Acc Blox Fruits - Pet hi·∫øm',game:'Blox Fruits',price:120,tags:['pet','dev'],img:'https://i.imgur.com/8Km9tLL.png',desc:'Acc c√≥ pet hi·∫øm, level cao, nhi·ªÅu qu√†.'},
        {id:'#rbx001',name:'Acc Adopt Me! - Full pet',game:'Adopt Me!',price:180,tags:['pet','full'],img:'https://i.imgur.com/1N8K3Kq.png',desc:'Full pet, ready to trade.'},
        {id:'#rbx002',name:'Acc Build A Boat - Starter',game:'Build A Boat',price:35,tags:['starter'],img:'https://i.imgur.com/5tj6S7Ol.png',desc:'Acc m·ªõi, gi√° r·∫ª.'}
      ];
      saveJSON(DB.accsKey,accs);
    }

    let users = loadJSON(DB.usersKey, []);
    let session = loadJSON(DB.sessionKey, null);

    // utility
    const $ = s=>document.querySelector(s);
    const $$ = s=>Array.from(document.querySelectorAll(s));

    // UI refs
    const grid = $('#grid');
    const searchInput = $('#searchInput');
    const searchBtn = $('#searchBtn');
    const tagList = $('#tagList');
    const categoryList = $('#categoryList');
    const priceRange = $('#priceRange');
    const priceMax = $('#priceMax');
    const sortBy = $('#sortBy');
    const walletBox = $('#walletBox');
    const authBtn = $('#authBtn');
    const logoutBtn = $('#logoutBtn');

    // derived lists
    function unique(arr){return [...new Set(arr)]}
    function getAllTags(){return unique(accs.flatMap(a=>a.tags||[]))}
    function getAllCategories(){return unique(accs.map(a=>a.game))}

    // make tag buttons
    let activeTags = new Set();
    let activeCategory = null;

    function renderTagButtons(){
      tagList.innerHTML='';
      getAllTags().forEach(t=>{
        const b = document.createElement('div');b.className='tag';b.textContent=t;
        if(activeTags.has(t))b.classList.add('active');
        b.onclick = ()=>{ if(activeTags.has(t))activeTags.delete(t); else activeTags.add(t); renderTagButtons(); renderGrid(); }
        tagList.appendChild(b);
      })
    }
    function renderCategoryButtons(){
      categoryList.innerHTML='';
      const all = document.createElement('div');all.className='tag';all.textContent='T·∫•t c·∫£'; if(!activeCategory)all.classList.add('active');
      all.onclick=()=>{activeCategory=null;renderCategoryButtons();renderGrid()}; categoryList.appendChild(all);
      getAllCategories().forEach(c=>{
        const b=document.createElement('div');b.className='tag';b.textContent=c; if(activeCategory===c)b.classList.add('active');
        b.onclick=()=>{activeCategory=c;renderCategoryButtons();renderGrid()}
        categoryList.appendChild(b);
      })
    }

    // render product grid
    function renderGrid(){
      const q = searchInput.value.trim().toLowerCase();
      const maxPrice = Number(priceRange.value);
      priceMax.textContent = maxPrice;
      let list = accs.filter(a=>a.price <= maxPrice);
      if(activeCategory) list = list.filter(a=>a.game===activeCategory);
      if(activeTags.size>0) list = list.filter(a=>Array.from(activeTags).every(t=>a.tags.includes(t)));
      if(q) list = list.filter(a=> (a.name+a.id+(a.tags||[]).join(' ')+a.game).toLowerCase().includes(q));

      // sort
      const s = sortBy.value;
      if(s==='price-asc') list.sort((x,y)=>x.price-y.price);
      else if(s==='price-desc') list.sort((x,y)=>y.price-x.price);
      else list.sort((x,y)=>0); // keep seed order, new later

      grid.innerHTML='';
      if(list.length===0) grid.innerHTML='<div class="muted-small">Kh√¥ng t√¨m th·∫•y acc n√†o ph√π h·ª£p.</div>';
      list.forEach(a=>{
        const el = document.createElement('div'); el.className='acc';
        el.innerHTML = `
          <div style="height:120px;overflow:hidden;border-radius:8px;background:#f1f5f9;display:flex;align-items:center;justify-content:center"><img src="${a.img}" alt="${a.name}" style="max-height:120px"/></div>
          <div class="title">${a.name}</div>
          <div class="id">${a.game} ¬∑ <span class="muted-small">${a.id}</span></div>
          <div class="tags">${(a.tags||[]).map(t=>`<span class="tag">${t}</span>`).join(' ')}</div>
          <div class="price">${a.price}k</div>
        `;
        el.onclick = ()=>openProduct(a);
        grid.appendChild(el);
      })
    }

    // product modal
    function openProduct(a){
      const tpl = document.getElementById('productModalTpl');
      const node = tpl.content.cloneNode(true);
      const backdrop = node.querySelector('.modal-backdrop');
      node.getElementById('prodImg').src = a.img||'';
      node.getElementById('prodName').textContent = a.name;
      node.getElementById('prodId').textContent = a.id;
      node.getElementById('prodDesc').textContent = a.desc||'';
      node.getElementById('prodPrice').textContent = a.price;
      const tagsCon = node.getElementById('prodTags');
      (a.tags||[]).forEach(t=>{const s=document.createElement('span');s.className='tag';s.textContent=t;tagsCon.appendChild(s)});

      node.getElementById('closeModal').onclick = ()=>backdrop.remove();
      node.getElementById('favBtn').onclick = ()=>{ alert('ƒê√£ th√™m v√†o y√™u th√≠ch (gi·∫£ l·∫≠p)'); };
      node.getElementById('buyBtn').onclick = ()=>{ buyAccount(a, backdrop) };

      document.body.appendChild(backdrop);
    }

    function buyAccount(a, backdrop){
      const sess = loadJSON(DB.sessionKey, null);
      if(!sess){
        alert('B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ mua.'); backdrop.remove(); openAuth(); return;
      }
      const users = loadJSON(DB.usersKey, []);
      const me = users.find(u=>u.username===sess.username);
      if(!me) { alert('T√†i kho·∫£n ng∆∞·ªùi d√πng kh√¥ng t·ªìn t·∫°i'); backdrop.remove(); return; }
      if(me.wallet >= a.price){
        if(!confirm(`X√°c nh·∫≠n mua ${a.name} - ${a.price}k ?`)) return;
        me.wallet -= a.price; saveJSON(DB.usersKey,users);
        // remove acc from list (simulate sold)
        accs = accs.filter(x=>x.id!==a.id);
        saveJSON(DB.accsKey,accs);
        saveJSON(DB.sessionKey, {username:me.username});
        alert('Mua th√†nh c√¥ng! S·ªë d∆∞ m·ªõi: ' + me.wallet + 'k');
        backdrop.remove(); renderGrid(); renderWallet(); renderCategoryButtons(); renderTagButtons();
      } else {
        alert('V√≠ kh√¥ng ƒë·ªß. Vui l√≤ng n·∫°p th√™m.');
      }
    }

    // auth modal
    function openAuth(){
      const tpl = document.getElementById('authTpl');
      const node = tpl.content.cloneNode(true);
      const back = node.querySelector('.modal-backdrop');
      document.body.appendChild(back);
      back.querySelector('#closeAuth').onclick = ()=>back.remove();
      back.querySelector('#doReg').onclick = ()=>{
        const u = back.querySelector('#regUser').value.trim(); const p = back.querySelector('#regPass').value;
        if(!u||!p){alert('Nh·∫≠p ƒë·ªß th√¥ng tin');return}
        const users = loadJSON(DB.usersKey,[]);
        if(users.find(x=>x.username===u)){alert('T√™n ƒë√£ t·ªìn t·∫°i');return}
        users.push({username:u,password:p,wallet:0}); saveJSON(DB.usersKey,users);
        alert('ƒêƒÉng k√Ω th√†nh c√¥ng! H√£y ƒëƒÉng nh·∫≠p.');
      }
      back.querySelector('#doLogin').onclick = ()=>{
        const u=back.querySelector('#loginUser').value.trim(); const p=back.querySelector('#loginPass').value;
        const users = loadJSON(DB.usersKey,[]);
        const me = users.find(x=>x.username===u && x.password===p);
        if(!me){alert('T√†i kho·∫£n ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng');return}
        saveJSON(DB.sessionKey,{username:me.username}); back.remove(); renderWallet(); renderAuthButtons();
        alert('ƒêƒÉng nh·∫≠p th√†nh c√¥ng!');
      }
    }

    // nap modal
    function openNap(){
      const tpl = document.getElementById('napTpl');
      const node = tpl.content.cloneNode(true);
      const back = node.querySelector('.modal-backdrop');
      document.body.appendChild(back);
      back.querySelector('#closeNap').onclick = ()=>back.remove();
      back.querySelector('#closeNap2').onclick = ()=>back.remove();
      back.querySelector('#confirmNap').onclick = ()=>{
        const v = Number(back.querySelector('#napAmount').value)||0;
        if(v<=0){alert('Nh·∫≠p s·ªë ti·ªÅn h·ª£p l·ªá');return}
        const sess = loadJSON(DB.sessionKey,null);
        if(!sess){alert('B·∫°n ph·∫£i ƒëƒÉng nh·∫≠p ƒë·ªÉ n·∫°p');back.remove(); openAuth();return}
        const users = loadJSON(DB.usersKey,[]);
        const me = users.find(x=>x.username===sess.username);
        if(!me){alert('Ng∆∞·ªùi d√πng kh√¥ng t·ªìn t·∫°i');back.remove();return}
        me.wallet = (me.wallet||0) + v; saveJSON(DB.usersKey,users);
        back.remove(); renderWallet(); alert('N·∫°p th√†nh c√¥ng +'+v+'k');
      }
    }

    // wallet & session UI
    function renderWallet(){
      const sess = loadJSON(DB.sessionKey,null);
      if(!sess){ walletBox.textContent='Ch∆∞a ƒëƒÉng nh·∫≠p'; logoutBtn.style.display='none'; authBtn.style.display='inline-block'; return }
      const users = loadJSON(DB.usersKey,[]);
      const me = users.find(x=>x.username===sess.username);
      walletBox.innerHTML = `<strong>${me.username}</strong><div class="muted-small">S·ªë d∆∞: ${me.wallet||0}k</div>`;
      logoutBtn.style.display='inline-block'; authBtn.style.display='none';
    }
    function renderAuthButtons(){ renderWallet(); }

    // interactions
    searchBtn.onclick = ()=>renderGrid();
    $('#btn-clear-filters').onclick = ()=>{ searchInput.value=''; activeTags=new Set(); activeCategory=null; priceRange.value=200; sortBy.value='new'; renderTagButtons(); renderCategoryButtons(); renderGrid(); };
    $('#btn-add-sample').onclick = ()=>{ // add a demo acc quickly
      const n = prompt('T√™n acc (vd: Acc test)'); if(!n) return; const id = '#rbx'+Math.floor(Math.random()*9999);
      const price = Number(prompt('Gi√° (k)',50))||50; const g = prompt('Game', 'Misc'); const t = prompt('Tags (ph√¢n t√°ch b·∫±ng d·∫•u ph·∫©y)','pet');
      const obj = {id, name:n, price, game:g, tags:(t||'').split(',').map(x=>x.trim()).filter(Boolean), img:'https://i.imgur.com/5tj6S7Ol.png', desc:'M√¥ t·∫£ ng·∫Øn'};
      accs.push(obj); saveJSON(DB.accsKey,accs); renderGrid(); renderCategoryButtons(); renderTagButtons();
    }

    priceRange.oninput = ()=>renderGrid(); sortBy.onchange = ()=>renderGrid();

    // auth nav
    authBtn.onclick = openAuth; $('#nav-nap').onclick = openNap; $('#openNap').onclick = openNap;
    $('#nav-help').onclick = ()=>alert('H∆∞·ªõng d·∫´n:
1) T√¨m acc b·∫±ng √¥ t√¨m ki·∫øm ho·∫∑c ch·ªçn tag.
2) B·∫•m v√†o acc ƒë·ªÉ xem chi ti·∫øt, sau ƒë√≥ mua b·∫±ng v√≠.
3) ƒêƒÉng k√Ω/ƒëƒÉng nh·∫≠p ƒë·ªÉ s·ª≠ d·ª•ng v√≠.');
    $('#nav-news').onclick = ()=>alert('Tin t·ª©c: ph·∫ßn tin t·ª©c ch∆∞a ƒë∆∞·ª£c tri·ªÉn khai (gi·∫£ l·∫≠p).');
    $('#homeBtn').onclick = ()=>{ searchInput.value=''; activeTags=new Set(); activeCategory=null; renderCategoryButtons(); renderTagButtons(); renderGrid(); }

    logoutBtn.onclick = ()=>{ localStorage.removeItem(DB.sessionKey); renderWallet(); renderAuthButtons(); alert('ƒê√£ ƒëƒÉng xu·∫•t'); }

    // initial render
    renderTagButtons(); renderCategoryButtons(); renderGrid(); renderWallet();

  </script>
</body>
</html>
<script>
const API_URL = "http://localhost:4000/api/auth";

// ---------- G·ªåI API ----------
async function apiRegister(username, password) {
  const res = await fetch(`${API_URL}/register`, {
    method: 'POST',
    credentials: 'include',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({ username, password })
  });
  return res.json();
}

async function apiLogin(username, password) {
  const res = await fetch(`${API_URL}/login`, {
    method: 'POST',
    credentials: 'include',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({ username, password })
  });
  return res.json();
}

async function apiMe() {
  const res = await fetch(`${API_URL}/me`, { credentials: 'include' });
  return res.json();
}

async function apiLogout() {
  await fetch(`${API_URL}/logout`, { method: 'POST', credentials: 'include' });
  location.reload();
}

// ---------- GIAO DI·ªÜN ----------
const loginForm = document.getElementById('loginForm');
const registerForm = document.getElementById('registerForm');
const userInfo = document.getElementById('userInfo');

async function checkUser() {
  const data = await apiMe();
  if (data.ok && data.user) {
    userInfo.innerHTML = `
      <p>Xin ch√†o <b>${data.user.username}</b>!</p>
      <p>üí∞ V√≠: ${data.user.wallet} VNƒê</p>
      <button onclick="apiLogout()">ƒêƒÉng xu·∫•t</button>
    `;
    document.querySelector('.auth-section').style.display = 'none';
    userInfo.style.display = 'block';
  }
}

// G·ª≠i form ƒëƒÉng k√Ω
if (registerForm) {
  registerForm.addEventListener('submit', async e => {
    e.preventDefault();
    const u = e.target.username.value.trim();
    const p = e.target.password.value.trim();
    const res = await apiRegister(u, p);
    if (res.ok) {
      alert('ƒêƒÉng k√Ω th√†nh c√¥ng!');
      checkUser();
    } else {
      alert(res.error || 'ƒêƒÉng k√Ω th·∫•t b·∫°i');
    }
  });
}

// G·ª≠i form ƒëƒÉng nh·∫≠p
if (loginForm) {
  loginForm.addEventListener('submit', async e => {
    e.preventDefault();
    const u = e.target.username.value.trim();
    const p = e.target.password.value.trim();
    const res = await apiLogin(u, p);
    if (res.ok) {
      alert('ƒêƒÉng nh·∫≠p th√†nh c√¥ng!');
      checkUser();
    } else {
      alert(res.error || 'Sai t√†i kho·∫£n ho·∫∑c m·∫≠t kh·∫©u');
    }
  });
}

// Ki·ªÉm tra khi load trang
checkUser();
</script>
